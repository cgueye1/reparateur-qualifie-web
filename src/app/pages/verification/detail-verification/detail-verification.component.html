<div class="w-full">

  <!-- ======================= CHARGEMENT ======================= -->
  <div *ngIf="loading" class="flex items-center justify-center h-64">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-[#008D36]"></div>
  </div>

  <!-- ======================= CONTENU ======================= -->
  <ng-container *ngIf="!loading">

    <!-- ======================= HEADER ======================= -->
    <div class="flex flex-col md:flex-row items-start md:items-center justify-between mb-6">

      <!-- RETOUR + NOM + ID -->
      <div class="flex items-start md:items-center gap-4">
        <!-- Retour -->
        <button (click)="goBack()"
          class="bg-[#F8FBF9] rounded-lg shadow p-1.5 flex items-center justify-center w-12 h-12">
          <svg width="18" height="14" viewBox="0 0 18 14" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M16.75 6.75H0.75M0.75 6.75L6.75 0.75M0.75 6.75L6.75 12.75" stroke="#2B3674" stroke-width="1.5"
              stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>

        <div>
          <h1 class="text-2xl font-semibold text-[#111]">{{ user.nom }}</h1>

        </div>
      </div>

      <!-- BOUTONS APPROUVER / REJETER -->
      <div class="flex items-center gap-4 mt-4 md:mt-0">

        <!-- Approuver -->
        <button (click)="openApprovePopup(demande)" class="px-6 py-2 rounded-lg font-medium text-white"
          style="background:#008D36;">
          Approuver
        </button>

        <!-- Rejeter -->
        <button (click)="openRejectPopup(demande)" class="px-6 py-2 rounded-lg font-medium text-white"
          style="background:#E95F32;">
          Rejeter
        </button>

      </div>
    </div>



    <!-- ========================== LAYOUT  ========================== -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-5 auto-rows-fr">


      <!-- ======================= COLONNE 1 : PROFIL ======================= -->
      <div class="bg-white rounded-2xl shadow-sm p-6 h-full">

        <!-- Bandeau -->
        <div
          class="w-full h-28 rounded-xl bg-gradient-to-r from-orange-50 to-gray-50 relative flex items-center justify-center">
          <div class="absolute -bottom-10">
            <div class="w-24 h-24 rounded-full overflow-hidden border-4 border-white shadow-md">
              <img *ngIf="getUserPhotoUrl()" [src]="getUserPhotoUrl()" class="w-full h-full object-cover" />
              <div *ngIf="!getUserPhotoUrl()"
                class="w-full h-full flex items-center justify-center bg-gray-300 text-[#555] font-bold text-2xl">
                {{ getUserInitials() }}
              </div>
            </div>

            <div class="w-4 h-4 rounded-full border-2 border-white absolute bg-[#008D36]"
              style="bottom: 2px; right: 20px;">

            </div>

          </div>
        </div>

        <div class="mt-14 text-center">
          <h2 class="text-xl font-semibold">{{ user.nom }}</h2>
          <p class="text-[#333333]">{{ user.metier }}</p>
        </div>

        <div class="my-6 border-t"></div>

        <!-- INFOS PROFIL -->
        <div class="flex flex-col gap-5 text-gray-700">

          <!-- Métier -->
          <div class="flex items-start justify-between">
            <div class="flex items-center gap-3">
              <svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M11.6667 2H9.33333V1.33333C9.3328 0.979874 9.19216 0.641042 8.94222 0.391109C8.69229 0.141175 8.35346 0.000529 8 0H5.33333C4.97987 0.000529 4.64104 0.141175 4.39111 0.391109C4.14117 0.641042 4.00053 0.979874 4 1.33333V2H1.66667C1.22464 2 0.800716 2.17559 0.488155 2.48816C0.175595 2.80072 0 3.22464 0 3.66667V10.3333C0 10.7754 0.175595 11.1993 0.488155 11.5118C0.800716 11.8244 1.22464 12 1.66667 12H11.6667C12.1087 12 12.5326 11.8244 12.8452 11.5118C13.1577 11.1993 13.3333 10.7754 13.3333 10.3333V3.66667C13.3333 3.22464 13.1577 2.80072 12.8452 2.48816C12.5326 2.17559 12.1087 2 11.6667 2ZM4.66667 1.33333C4.66667 1.15652 4.7369 0.986953 4.86193 0.861929C4.98695 0.736905 5.15652 0.666667 5.33333 0.666667H8C8.17681 0.666667 8.34638 0.736905 8.4714 0.861929C8.59643 0.986953 8.66667 1.15652 8.66667 1.33333V2H4.66667V1.33333ZM12.6667 10.3333C12.6667 10.5985 12.5613 10.8529 12.3738 11.0404C12.1862 11.228 11.9319 11.3333 11.6667 11.3333H1.66667C1.40145 11.3333 1.1471 11.228 0.95956 11.0404C0.772023 10.8529 0.666667 10.5985 0.666667 10.3333V6.018L4.56133 7.31667C4.59532 7.32784 4.63089 7.33347 4.66667 7.33333H8.66667C8.70244 7.33347 8.73801 7.32784 8.772 7.31667L12.6667 6.018V10.3333ZM12.6667 5.33733C12.6311 5.33612 12.5955 5.34062 12.5613 5.35067L8.61267 6.66667H4.72067L0.772 5.35C0.737827 5.33996 0.702265 5.33545 0.666667 5.33667V3.66667C0.666667 3.40145 0.772023 3.1471 0.95956 2.95956C1.1471 2.77202 1.40145 2.66667 1.66667 2.66667H11.6667C11.9319 2.66667 12.1862 2.77202 12.3738 2.95956C12.5613 3.1471 12.6667 3.40145 12.6667 3.66667V5.33733Z"
                  fill="#64748B" />
              </svg>
              <span class="text-sm">{{ user.metier }}</span>
            </div>
            <span class="text-[#64748B] text-xs">Métier</span>
          </div>

          <!-- Email -->
          <div class="flex items-center gap-3">
            <svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M0 2C0 1.46957 0.210714 0.960859 0.585786 0.585786C0.960859 0.210714 1.46957 0 2 0H14C14.5304 0 15.0391 0.210714 15.4142 0.585786C15.7893 0.960859 16 1.46957 16 2V10C16 10.5304 15.7893 11.0391 15.4142 11.4142C15.0391 11.7893 14.5304 12 14 12H2C1.46957 12 0.960859 11.7893 0.585786 11.4142C0.210714 11.0391 0 10.5304 0 10V2ZM2 1C1.73478 1 1.48043 1.10536 1.29289 1.29289C1.10536 1.48043 1 1.73478 1 2V2.217L8 6.417L15 2.217V2C15 1.73478 14.8946 1.48043 14.7071 1.29289C14.5196 1.10536 14.2652 1 14 1H2ZM15 3.383L10.292 6.208L15 9.105V3.383ZM14.966 10.259L9.326 6.788L8 7.583L6.674 6.788L1.034 10.258C1.09083 10.4708 1.21632 10.6589 1.39099 10.7931C1.56566 10.9272 1.77975 11 2 11H14C14.2201 11 14.4341 10.9274 14.6088 10.7934C14.7834 10.6595 14.909 10.4716 14.966 10.259ZM1 9.105L5.708 6.208L1 3.383V9.105Z"
                fill="#64748B" />
            </svg>
            <span class="text-sm">{{ user.email }}</span>
          </div>

          <!-- Téléphone -->
          <div class="flex items-center gap-3">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M3.65398 1.32829C3.59495 1.25236 3.52043 1.18985 3.43538 1.14492C3.35034 1.09999 3.2567 1.07368 3.1607 1.06772C3.0647 1.06176 2.96853 1.07629 2.87858 1.11036C2.78863 1.14442 2.70695 1.19724 2.63898 1.26529L1.60498 2.30029C1.12198 2.78429 0.943983 3.4693 1.15498 4.0703C2.03171 6.5574 3.45614 8.8157 5.32298 10.6783C7.18557 12.5451 9.44387 13.9696 11.931 14.8463C12.532 15.0573 13.217 14.8793 13.701 14.3963L14.735 13.3623C14.803 13.2943 14.8559 13.2127 14.8899 13.1227C14.924 13.0327 14.9385 12.9366 14.9326 12.8406C14.9266 12.7446 14.9003 12.6509 14.8554 12.5659C14.8104 12.4808 14.7479 12.4063 14.672 12.3473L12.365 10.5533C12.2838 10.4905 12.1894 10.4469 12.089 10.4258C11.9885 10.4046 11.8846 10.4065 11.785 10.4313L9.59498 10.9783C9.30264 11.0509 8.99651 11.0467 8.70623 10.9663C8.41594 10.8859 8.15132 10.7319 7.93798 10.5193L5.48198 8.06229C5.26916 7.84906 5.115 7.58449 5.03441 7.2942C4.95382 7.0039 4.94954 6.69773 5.02198 6.4053L5.56998 4.2153C5.59474 4.11568 5.59663 4.01175 5.5755 3.9113C5.55437 3.81086 5.51078 3.71649 5.44798 3.63529L3.65398 1.32829ZM1.88398 0.511295C2.05898 0.336244 2.26921 0.200425 2.50072 0.112856C2.73223 0.0252871 2.97973 -0.0120282 3.22676 0.00338804C3.4738 0.0188043 3.71474 0.0865995 3.93356 0.202272C4.15239 0.317944 4.34411 0.478846 4.49598 0.674295L6.28998 2.98029C6.61898 3.4033 6.73498 3.9543 6.60498 4.4743L6.05798 6.6643C6.0299 6.77773 6.03153 6.8965 6.0627 7.00913C6.09388 7.12175 6.15356 7.22445 6.23598 7.3073L8.69298 9.76429C8.77593 9.84688 8.87879 9.90666 8.99161 9.93785C9.10443 9.96903 9.2234 9.97056 9.33698 9.9423L11.526 9.3953C11.7826 9.33151 12.0504 9.32671 12.3091 9.38127C12.5679 9.43583 12.8109 9.54832 13.02 9.71029L15.326 11.5043C16.155 12.1493 16.231 13.3743 15.489 14.1153L14.455 15.1493C13.715 15.8893 12.609 16.2143 11.578 15.8513C8.93865 14.9239 6.54252 13.413 4.56798 11.4313C2.58636 9.45704 1.07553 7.06126 0.147983 4.4223C-0.214017 3.3923 0.110983 2.2853 0.850983 1.54529L1.88398 0.511295Z"
                fill="#64748B" />
            </svg>
            <span class="text-sm">{{ user.telephone }}</span>
          </div>

          <!-- Ville -->
          <div class="flex items-center gap-3">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M3.1 11.2C3.14657 11.1379 3.20697 11.0875 3.27639 11.0528C3.34582 11.0181 3.42238 11 3.5 11H6C6.13261 11 6.25979 11.0527 6.35355 11.1464C6.44732 11.2402 6.5 11.3674 6.5 11.5C6.5 11.6326 6.44732 11.7598 6.35355 11.8536C6.25979 11.9473 6.13261 12 6 12H3.75L1.5 15H14.5L12.25 12H10C9.86739 12 9.74021 11.9473 9.64645 11.8536C9.55268 11.7598 9.5 11.6326 9.5 11.5C9.5 11.3674 9.55268 11.2402 9.64645 11.1464C9.74021 11.0527 9.86739 11 10 11H12.5C12.5776 11 12.6542 11.0181 12.7236 11.0528C12.793 11.0875 12.8534 11.1379 12.9 11.2L15.9 15.2C15.9557 15.2743 15.9896 15.3626 15.998 15.4551C16.0063 15.5476 15.9887 15.6406 15.9472 15.7236C15.9057 15.8067 15.8419 15.8765 15.7629 15.9253C15.6839 15.9741 15.5929 16 15.5 16H0.5C0.407144 16 0.316123 15.9741 0.237135 15.9253C0.158147 15.8765 0.0943131 15.8067 0.0527866 15.7236C0.0112602 15.6406 -0.00631841 15.5476 0.00202058 15.4551C0.0103596 15.3626 0.0442867 15.2743 0.1 15.2L3.1 11.2Z"
                fill="#64748B" />
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M8 0.999629C7.60603 0.999629 7.21593 1.07723 6.85195 1.22799C6.48797 1.37875 6.15726 1.59973 5.87868 1.87831C5.6001 2.15688 5.37913 2.4876 5.22836 2.85158C5.0776 3.21556 5 3.60566 5 3.99963C5 4.39359 5.0776 4.7837 5.22836 5.14768C5.37913 5.51166 5.6001 5.84237 5.87868 6.12095C6.15726 6.39953 6.48797 6.6205 6.85195 6.77127C7.21593 6.92203 7.60603 6.99963 8 6.99963C8.79565 6.99963 9.55871 6.68356 10.1213 6.12095C10.6839 5.55834 11 4.79528 11 3.99963C11 3.20398 10.6839 2.44092 10.1213 1.87831C9.55871 1.3157 8.79565 0.999629 8 0.999629ZM4 3.99963C4.00007 3.22986 4.22226 2.47645 4.63989 1.82982C5.05753 1.18319 5.65288 0.670801 6.3545 0.354136C7.05613 0.0374708 7.83422 -0.0700184 8.59542 0.044566C9.35662 0.15915 10.0686 0.490941 10.6459 1.00013C11.2232 1.50931 11.6413 2.17426 11.8501 2.91518C12.0589 3.65611 12.0494 4.44153 11.8228 5.17722C11.5963 5.9129 11.1623 6.56759 10.5729 7.06272C9.98349 7.55786 9.26374 7.87241 8.5 7.96863V13.4996C8.5 13.6322 8.44732 13.7594 8.35355 13.8532C8.25979 13.947 8.13261 13.9996 8 13.9996C7.86739 13.9996 7.74022 13.947 7.64645 13.8532C7.55268 13.7594 7.5 13.6322 7.5 13.4996V7.96963C6.53297 7.84779 5.64369 7.37707 4.99922 6.64586C4.35474 5.91466 3.99942 4.97431 4 3.99963Z"
                fill="#64748B" />
            </svg>
            <span class="text-sm">{{ user.ville }}</span>
          </div>

          <!-- Date inscription -->
          <div class="flex items-start justify-between">
            <div class="flex items-center gap-3">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M8 7C8.13261 7 8.25979 7.05268 8.35355 7.14645C8.44732 7.24021 8.5 7.36739 8.5 7.5V9H10C10.1326 9 10.2598 9.05268 10.3536 9.14645C10.4473 9.24021 10.5 9.36739 10.5 9.5C10.5 9.63261 10.4473 9.75979 10.3536 9.85355C10.2598 9.94732 10.1326 10 10 10H8.5V11.5C8.5 11.6326 8.44732 11.7598 8.35355 11.8536C8.25979 11.9473 8.13261 12 8 12C7.86739 12 7.74021 11.9473 7.64645 11.8536C7.55268 11.7598 7.5 11.6326 7.5 11.5V10H6C5.86739 10 5.74021 9.94732 5.64645 9.85355C5.55268 9.75979 5.5 9.63261 5.5 9.5C5.5 9.36739 5.55268 9.24021 5.64645 9.14645C5.74021 9.05268 5.86739 9 6 9H7.5V7.5C7.5 7.36739 7.55268 7.24021 7.64645 7.14645C7.74021 7.05268 7.86739 7 8 7Z"
                  fill="#64748B" />
                <path
                  d="M3.5 0C3.63261 0 3.75979 0.0526784 3.85355 0.146447C3.94732 0.240215 4 0.367392 4 0.5V1H12V0.5C12 0.367392 12.0527 0.240215 12.1464 0.146447C12.2402 0.0526784 12.3674 0 12.5 0C12.6326 0 12.7598 0.0526784 12.8536 0.146447C12.9473 0.240215 13 0.367392 13 0.5V1H14C14.5304 1 15.0391 1.21071 15.4142 1.58579C15.7893 1.96086 16 2.46957 16 3V14C16 14.5304 15.7893 15.0391 15.4142 15.4142C15.0391 15.7893 14.5304 16 14 16H2C1.46957 16 0.960859 15.7893 0.585786 15.4142C0.210714 15.0391 0 14.5304 0 14V3C0 2.46957 0.210714 1.96086 0.585786 1.58579C0.960859 1.21071 1.46957 1 2 1H3V0.5C3 0.367392 3.05268 0.240215 3.14645 0.146447C3.24021 0.0526784 3.36739 0 3.5 0ZM1 4V14C1 14.2652 1.10536 14.5196 1.29289 14.7071C1.48043 14.8946 1.73478 15 2 15H14C14.2652 15 14.5196 14.8946 14.7071 14.7071C14.8946 14.5196 15 14.2652 15 14V4H1Z"
                  fill="#64748B" />
              </svg>
              <span class="text-sm">{{ user.dateInscription }}</span>
            </div>
            <span class="text-[#64748B] text-xs">Date d’inscription</span>
          </div>

        </div>

      </div>




      <!-- ======================= COLONNE DROITE ======================= -->
      <div class="lg:col-span-2 bg-white rounded-2xl shadow-sm p-6">

        <!-- TITRE + STATUT -->
        <div class="flex items-start justify-between mb-6">
          <h2 class="text-2xl font-semibold text-[#2C3E50]">Informations sur la demande</h2>

          <span class="px-3 py-1 rounded-full text-xs font-medium" [ngClass]="
                demande.statut === 'En attente' ? 'bg-gray-100 text-gray-600' :
                demande.statut === 'Validée' ? 'bg-[#E6F5EC] text-[#008D36]' :
                'bg-[#FFECEC] text-[#FF2828]'">
            {{ demande.statut }}
          </span>
        </div>


        <!-- INFOS DE LA DEMANDE -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 text-sm">

          <div>
            <p class="text-gray-500 text-xs">Date de demande</p>
            <p class="font-semibold">{{ demande.date }}</p>
          </div>

          <div>
            <p class="text-gray-500 text-xs">Plan Abonnement</p>
            <p class="font-semibold">{{ demande.plan }}</p>
          </div>

          <div>
            <p class="text-gray-500 text-xs">Montant Payé</p>
            <p class="font-semibold">{{ demande.montant }}</p>
          </div>

        </div>



        <!-- ======================= DOCUMENTS ======================= -->
        <h3 class="text-base text-[#2C3E50] font-semibold mb-4">Documents fournis ({{ documents.length }})</h3>

        <!-- Chargement des documents -->
        <div *ngIf="loadingDocuments" class="flex items-center justify-center py-8">
          <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-[#008D36]"></div>
          <span class="ml-3 text-gray-500">Chargement des documents...</span>
        </div>

        <!-- Aucun document -->
        <div *ngIf="!loadingDocuments && documents.length === 0" class="text-center py-8 text-gray-500">
          <p>Aucun document fourni</p>
        </div>

        <!-- Liste des documents -->
        <div *ngIf="!loadingDocuments && documents.length > 0" class="grid grid-cols-1 md:grid-cols-2 gap-4">

          <div *ngFor="let doc of documents"
            class="flex items-center justify-between border border-[#EFF6FF] rounded-xl p-5 bg-white cursor-pointer">

            <div class="flex items-center gap-3">
              <!-- Icône PDF -->
              <span class="inline-flex px-3 py-2 rounded-lg bg-[#F4F7FE]">
                <svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M9 7H14.5L9 1.5V7ZM2 0H10L16 6V18C16 18.5304 15.7893 19.0391 15.4142 19.4142C15.0391 19.7893 14.5304 20 14 20H2C1.46957 20 0.960859 19.7893 0.585786 19.4142C0.210714 19.0391 0 18.5304 0 18V2C0 1.46957 0.210714 0.960859 0.585786 0.585786C0.960859 0.210714 1.46957 0 2 0ZM6.93 10.44C7.34 11.34 7.86 12.08 8.46 12.59L8.87 12.91C8 13.07 6.8 13.35 5.53 13.84L5.42 13.88L5.92 12.84C6.37 11.97 6.7 11.18 6.93 10.44ZM13.41 14.25C13.59 14.07 13.68 13.84 13.69 13.59C13.72 13.39 13.67 13.2 13.57 13.04C13.28 12.57 12.53 12.35 11.29 12.35L10 12.42L9.13 11.84C8.5 11.32 7.93 10.41 7.53 9.28L7.57 9.14C7.9 7.81 8.21 6.2 7.55 5.54C7.46927 5.46161 7.37378 5.40003 7.26907 5.35883C7.16435 5.31763 7.0525 5.29764 6.94 5.3H6.7C6.33 5.3 6 5.69 5.91 6.07C5.54 7.4 5.76 8.13 6.13 9.34V9.35C5.88 10.23 5.56 11.25 5.05 12.28L4.09 14.08L3.2 14.57C2 15.32 1.43 16.16 1.32 16.69C1.28 16.88 1.3 17.05 1.37 17.23L1.4 17.28L1.88 17.59L2.32 17.7C3.13 17.7 4.05 16.75 5.29 14.63L5.47 14.56C6.5 14.23 7.78 14 9.5 13.81C10.53 14.32 11.74 14.55 12.5 14.55C12.94 14.55 13.24 14.44 13.41 14.25ZM13 13.54L13.09 13.65C13.08 13.75 13.05 13.76 13 13.78H12.96L12.77 13.8C12.31 13.8 11.6 13.61 10.87 13.29C10.96 13.19 11 13.19 11.1 13.19C12.5 13.19 12.9 13.44 13 13.54ZM3.83 15C3.18 16.19 2.59 16.85 2.14 17C2.19 16.62 2.64 15.96 3.35 15.31L3.83 15ZM6.85 8.09C6.62 7.19 6.61 6.46 6.78 6.04L6.85 5.92L7 5.97C7.17 6.21 7.19 6.53 7.09 7.07L7.06 7.23L6.9 8.05L6.85 8.09Z"
                    fill="#EF5350" />
                </svg></span>


              <div>
                <p class="font-medium text-[#2B3674] text-sm lg:text-base">{{ doc.nom }}</p>
                <p class="text-xs text-[#A3AED0]">{{ doc.taille }}</p>
              </div>
            </div>

            <!-- Téléchargement -->
            <a [href]="doc.url" target="_blank" class="text-gray-500 hover:text-[#008D36]" title="Télécharger">
              <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M7 10.577L3.461 7.039L4.169 6.319L6.5 8.65V0H7.5V8.65L9.83 6.32L10.539 7.039L7 10.577ZM1.616 14C1.15533 14 0.771 13.846 0.463 13.538C0.155 13.23 0.000666667 12.8453 0 12.384V9.961H1V12.384C1 12.538 1.064 12.6793 1.192 12.808C1.32 12.9367 1.461 13.0007 1.615 13H12.385C12.5383 13 12.6793 12.936 12.808 12.808C12.9367 12.68 13.0007 12.5387 13 12.384V9.961H14V12.384C14 12.8447 13.846 13.229 13.538 13.537C13.23 13.845 12.8453 13.9993 12.384 14H1.616Z"
                  fill="#8F9BBA" />
              </svg>
            </a>
          </div>

        </div>

      </div>

    </div>

  </ng-container>

</div>



<!-- POPUP CONFIRM APPROUVER -->
<div *ngIf="showApproveConfirm" class="fixed inset-0 z-50 bg-black/40 flex items-center justify-center p-4">
  <div class="bg-white rounded-2xl px-10 py-12 w-[460px] text-center shadow-xl">

    <!-- Icône -->
    <div class="w-full flex items-center justify-center mb-6">
      <svg width="65" height="65" viewBox="0 0 95 95" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M51.2407 58.166L43.8188 58.166L43.8188 28.4785L51.2407 28.4785L51.2407 58.166Z" fill="#EFBD8E" />
        <path
          d="M47.5 65.291C45.3685 65.291 43.6406 67.0189 43.6406 69.1504C43.6406 71.2819 45.3685 73.0098 47.5 73.0098C49.6315 73.0098 51.3594 71.2819 51.3594 69.1504C51.3594 67.0189 49.6315 65.291 47.5 65.291Z"
          fill="#EFBD8E" />
        <path
          d="M47.5 94.9776C59.6972 95.3703 71.5436 90.595 80.446 81.6968C89.3483 72.7986 94.5815 60.5025 95 47.5C94.5815 34.4975 89.3483 22.2014 80.446 13.3032C71.5436 4.40504 59.6972 -0.370316 47.5 0.0224457C35.3028 -0.370316 23.4564 4.40504 14.554 13.3032C5.65166 22.2014 0.418472 34.4975 0 47.5C0.418472 60.5025 5.65166 72.7986 14.554 81.6968C23.4564 90.595 35.3028 95.3703 47.5 94.9776ZM47.5 7.93537C57.7293 7.54133 67.6886 11.4827 75.1994 18.8972C82.7101 26.3117 87.1609 36.5959 87.5781 47.5C87.1609 58.4041 82.7101 68.6883 75.1994 76.1028C67.6886 83.5174 57.7293 87.4587 47.5 87.0646C37.2707 87.4587 27.3114 83.5174 19.8006 76.1028C12.2899 68.6883 7.83908 58.4041 7.42188 47.5C7.83908 36.5959 12.2899 26.3117 19.8006 18.8972C27.3114 11.4827 37.2707 7.54133 47.5 7.93537Z"
          fill="#EFBD8E" />
      </svg>
    </div>

    <h2 class="text-xl font-bold mb-2">Approuver la demande</h2>

    <p class="text-sm text-gray-600 mb-8">
      Êtes-vous sûr de vouloir <b>approuver</b> cette demande ?
    </p>

    <div class="flex justify-center gap-4">
      <button (click)="confirmApprove()" class="bg-green-600 text-white px-8 py-3 rounded-lg hover:bg-green-700">
        Approuver
      </button>
      <button (click)="closeAllPopups()" class="bg-gray-100 px-8 py-3 rounded-lg hover:bg-gray-200">
        Annuler
      </button>
    </div>

  </div>
</div>




<!-- POPUP REJET MOTIF -->
<div *ngIf="showRejectForm" class="fixed inset-0 z-50 bg-black/40 flex items-center justify-center p-4">
  <div class="bg-white rounded-2xl px-10 py-10 w-[520px] shadow-xl">

    <div class="flex justify-between items-start mb-4">
      <h2 class="text-xl font-bold">Rejeter la demande</h2>

      <button (click)="closeAllPopups()" class="text-gray-500 hover:text-gray-800">
        ✕
      </button>
    </div>

    <p class="text-sm text-gray-600 mb-5">
      Veuillez indiquer la raison du rejet. L'artisan recevra cette information par email.
    </p>

    <label class="text-sm font-semibold text-gray-700">Motif du rejet</label>
    <textarea [(ngModel)]="rejectReason" class="w-full border border-gray-300 rounded-lg p-3 text-sm mt-2" rows="4"
      placeholder="Ex : Documents incomplets, photo de mauvaise qualité..."></textarea>

    <div class="flex justify-end gap-4 mt-6">
      <button (click)="confirmReject()" class="bg-[#E95420] text-white px-6 py-3 rounded-lg hover:bg-[#d64515]">
        Confirmer le rejet
      </button>

      <button (click)="closeAllPopups()" class="bg-gray-100 px-6 py-3 rounded-lg hover:bg-gray-200">
        Annuler
      </button>
    </div>

  </div>
</div>


<!-- SUCCESS APPROUVE -->
<div *ngIf="showSuccessApprove" class="fixed inset-0 z-50 bg-black/40 flex items-center justify-center p-4">
  <div class="bg-white rounded-2xl w-[420px] p-10 text-center shadow-xl">

    <div class="w-full flex items-center justify-center mb-4">
      <svg width="65" height="65" viewBox="0 0 95 95" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M70.2452 34.0264C70.9106 34.7294 71.27 35.6677 71.2443 36.6353C71.2186 37.6029 70.81 38.5208 70.1082 39.1875L43.3438 64.7644C42.6518 65.4153 41.736 65.7751 40.7861 65.7692C39.8501 65.7728 38.9494 65.4125 38.2741 64.7644L24.8918 51.976C24.5207 51.6521 24.2188 51.2566 24.0044 50.8131C23.79 50.3696 23.6675 49.8874 23.6442 49.3954C23.6209 48.9033 23.6973 48.4117 23.8689 47.9499C24.0405 47.4882 24.3037 47.0659 24.6426 46.7085C24.9816 46.3511 25.3893 46.0659 25.8413 45.87C26.2932 45.6742 26.7801 45.5718 27.2727 45.5689C27.7653 45.566 28.2534 45.6628 28.7076 45.8534C29.1618 46.044 29.5728 46.3244 29.9159 46.6779L40.7861 57.0457L65.0841 33.8894C65.7871 33.224 66.7254 32.8646 67.693 32.8903C68.6606 32.916 69.5785 33.3246 70.2452 34.0264ZM95 47.5C95 56.8946 92.2142 66.0782 86.9948 73.8896C81.7754 81.7009 74.357 87.7891 65.6775 91.3843C56.998 94.9794 47.4473 95.9201 38.2332 94.0873C29.0191 92.2545 20.5554 87.7305 13.9124 81.0876C7.26945 74.4446 2.74552 65.9809 0.91272 56.7668C-0.920077 47.5527 0.020581 38.002 3.61574 29.3225C7.2109 20.643 13.2991 13.2246 21.1104 8.00519C28.9218 2.78583 38.1054 0 47.5 0C60.0904 0.0241427 72.1582 5.03635 81.0609 13.9391C89.9637 22.8418 94.9759 34.9096 95 47.5ZM87.6923 47.5C87.6923 39.5507 85.3351 31.7799 80.9187 25.1703C76.5023 18.5608 70.2251 13.4092 62.8809 10.3671C55.5368 7.32509 47.4554 6.52915 39.6589 8.07997C31.8623 9.6308 24.7008 13.4587 19.0798 19.0797C13.4588 24.7007 9.63082 31.8623 8.08 39.6589C6.52917 47.4554 7.32511 55.5367 10.3672 62.8809C13.4092 70.2251 18.5608 76.5023 25.1704 80.9187C31.78 85.3351 39.5507 87.6923 47.5 87.6923C58.156 87.6802 68.372 83.4418 75.9069 75.9069C83.4418 68.372 87.6802 58.1559 87.6923 47.5Z"
          fill="#008D36" />
      </svg>
    </div>

    <p class="text-lg font-medium text-gray-700">
      Vérification approuvée avec succès
    </p>

  </div>
</div>


<!-- SUCCESS REJET -->
<div *ngIf="showSuccessReject" class="fixed inset-0 z-50 bg-black/40 flex items-center justify-center p-4">
  <div class="bg-white rounded-2xl w-[420px] p-10 text-center shadow-xl">

    <div class="w-full flex items-center justify-center mb-4">
      <svg width="65" height="65" viewBox="0 0 95 95" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M70.2452 34.0264C70.9106 34.7294 71.27 35.6677 71.2443 36.6353C71.2186 37.6029 70.81 38.5208 70.1082 39.1875L43.3438 64.7644C42.6518 65.4153 41.736 65.7751 40.7861 65.7692C39.8501 65.7728 38.9494 65.4125 38.2741 64.7644L24.8918 51.976C24.5207 51.6521 24.2188 51.2566 24.0044 50.8131C23.79 50.3696 23.6675 49.8874 23.6442 49.3954C23.6209 48.9033 23.6973 48.4117 23.8689 47.9499C24.0405 47.4882 24.3037 47.0659 24.6426 46.7085C24.9816 46.3511 25.3893 46.0659 25.8413 45.87C26.2932 45.6742 26.7801 45.5718 27.2727 45.5689C27.7653 45.566 28.2534 45.6628 28.7076 45.8534C29.1618 46.044 29.5728 46.3244 29.9159 46.6779L40.7861 57.0457L65.0841 33.8894C65.7871 33.224 66.7254 32.8646 67.693 32.8903C68.6606 32.916 69.5785 33.3246 70.2452 34.0264ZM95 47.5C95 56.8946 92.2142 66.0782 86.9948 73.8896C81.7754 81.7009 74.357 87.7891 65.6775 91.3843C56.998 94.9794 47.4473 95.9201 38.2332 94.0873C29.0191 92.2545 20.5554 87.7305 13.9124 81.0876C7.26945 74.4446 2.74552 65.9809 0.91272 56.7668C-0.920077 47.5527 0.020581 38.002 3.61574 29.3225C7.2109 20.643 13.2991 13.2246 21.1104 8.00519C28.9218 2.78583 38.1054 0 47.5 0C60.0904 0.0241427 72.1582 5.03635 81.0609 13.9391C89.9637 22.8418 94.9759 34.9096 95 47.5ZM87.6923 47.5C87.6923 39.5507 85.3351 31.7799 80.9187 25.1703C76.5023 18.5608 70.2251 13.4092 62.8809 10.3671C55.5368 7.32509 47.4554 6.52915 39.6589 8.07997C31.8623 9.6308 24.7008 13.4587 19.0798 19.0797C13.4588 24.7007 9.63082 31.8623 8.08 39.6589C6.52917 47.4554 7.32511 55.5367 10.3672 62.8809C13.4092 70.2251 18.5608 76.5023 25.1704 80.9187C31.78 85.3351 39.5507 87.6923 47.5 87.6923C58.156 87.6802 68.372 83.4418 75.9069 75.9069C83.4418 68.372 87.6802 58.1559 87.6923 47.5Z"
          fill="#008D36" />
      </svg>
    </div>

    <p class="text-lg font-medium text-gray-700">
      Demande rejetée.
    </p>

  </div>
</div>